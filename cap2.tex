%\chapter{Problem\'atica de la Individualizaci\'on de Filamentos a partir de un Grafo}
\chapter{An\'alisis de Filamentos en Grafos}
\label{chap:cap2}

%problema previo, o problema 0 que consiste en la generaci\'on de un grafo a partir de una imagen que contenga una red, que en este caso, representaria a una red de filamentos. 

En base lo expuesto en el cap\'itulo \ref{chap:stateoftheart}, para el enfoque de utilizar grafos para la individualizaci\'on de filamentos existe una brecha entre la obtenci\'on del grafo y su an\'alisis. Este paso previo, la extracci\'on de un grafo a partir de una imagen, consiste en extraer un grafo $G = (V,E)$ de una imagen tal que $G$ sea un grafo simple, no dirigido, ponderado, conectado o desconectado, con o sin ciclos. Esto implica que exista a lo m\'as 1 arista por cada par de nodos adyacentes, prohibi\'endose la existencia de nodos conectados consigo mismos. Se definen los v\'ertices/nodos del grafo $G$ como $V(G)$ y las aristas de $G$ como $E(G)$. 
Que el grafo $G$ sea ponderado implica que para las aristas del grafo ($E(G)$), existen caracter\'isticas asociadas que se expresan como caracter\'isticas geom\'etricas, topol\'ogicas, espaciales y/u otras. Es importante evitar que $G$ sea un grafo completo, dado que con n nodos/v\'ertices $G$ llega a tener $\frac{n(n-1)}{2}$ aristas.
%$\forall e \in \quad E(G) \quad  \exists $ 

Algunas de las dificultades involucradas en la extracci\'on de informaci\'on a partir de una imagen se encuentran en los m\'etodos presentados en el cap\'itulo \ref{chap:stateoftheart}, dentro de las que destacan el ruido y la resoluci\'on. Un ejemplo de aquello se observa en la figura \ref{fig:NoConsenso}.

\begin{figure*}[h]
    \begin{tabular}{c c c}
        \multirow[c]{2}{*}[2.5cm]{
        \begin{subfigure}[t]{0.4\textwidth}
        \includegraphics[scale=0.5]{imagenes/NoConsenso.png}
        \caption{Microt\'ubulos en planta {\it Marchantia}.\\Fuente: Paula Llanos}
        \label{fig:NoConsensoGeneral}
        \end{subfigure}  
        }
        &
        \multirow[c]{2}{*}[2cm]{
        \begin{subfigure}[t]{0.25\textwidth}
        \includegraphics[]{imagenes/NoConsenso2.png}
        \caption{Secci\'on resaltada en rojo de \ref{fig:NoConsensoGeneral}}
        \label{fig:NoConsensoRect}
        \end{subfigure}
        }
        &
        \begin{subfigure}[t]{0.21\textwidth}
        \includegraphics[scale=0.8]{imagenes/NoConsenso3.png}
        \caption{Opci\'on 1 de microt\'ubulos en \ref{fig:NoConsensoRect}}
        \label{fig:NoConsensoOpcion1}
        \end{subfigure} \\
        & &
        \begin{subfigure}[b]{0.21\textwidth}
        \includegraphics[scale=0.8]{imagenes/NoConsenso4.png}
        \caption{Opci\'on 2 de microt\'ubulos en \ref{fig:NoConsensoRect}}
        \label{fig:NoConsensoOpcion2}
        \end{subfigure} \\
    \end{tabular}
    
    \caption{Dificultad de individualizaci\'on que enfretan los expertos al analizar manualmente una imagen de filamentos, en particular, microt\'ubulos.}
    \label{fig:NoConsenso}
\end{figure*}

Mientras que el ruido ha sido estudiado en la literatura, el problema de resoluci\'on de filamentos depende principalmente de la capacidad del microscopio que se utilice. Como se menciona en la introducci\'on, el l\'imite m\'aximo de resoluci\'on, denominado $\frac{\lambda}{2}$, determina el tama\~no m\'inimo que 2 objetos que se encuentren juntos pueden tener para no observarse como un \'unico elemento. Lo anterior sucede para algunos tipos de filamentos como los microt\'ubulos que pueden medir tan solo 25 nan\'ometros, lo que se encuentra por debajo de $\frac{\lambda}{2}$ para diversos microscopios. 



Una vez obtenido el grafo que representa una red de filamentos, el problema siguiente se encuentra en el que 2 expertos pueden discernir con respecto a los filamentos identificables en una imagen, por lo que no es posible conocer a priori del origen y el final de un filamento, para las resoluciones actuales de las imagenes obtenidas a partir de la microscop\'ia. Una dificultad adicional se presenta en la representaci\'on de un filamento en un grafo, ya que esta se basa en un conjunto de aristas adyacentes, denominadas caminos o recorridos, lo que lleva a tener un universo de hasta $n!$ posibles combinaciones en el espacio de soluciones en el que se busca un camino.

A partir del problema anterior, el problema final en la individualizaci\'on de filamentos lo constituye la elecci\'on del subconjunto de caminos, que debe ser seleccionado entre el total de caminos que representan soluciones factibles. Esto implica que el problema no solo sea un problema combinatorial de generar soluciones factibles a partir del conjunto de aristas, sino que adem\'as debe considerar la discriminaci\'on entre estos para obtener el subconjunto de mayor calidad, pudiendo representarse como un problema de optimizaci\'on combinatorial.

Los 3 problemas presentados se formalizan a continuaci\'on.

%problema previo
%presentar el problema previo, como un puente necesario en la automatizaci\'on de la extracci\'on,  para analizar un grafo que representa la red de filamentos, que de lo contrario tendria que ser realizado a mano, implicando que la persona realizando el análisis podría llevar a cabo la individualizaci\'on de filamentos en el mismo acto.

\section{Generaci\'on de un Grafo desde una Imagen}
La extraci\'on o generaci\'on de un grafo que representa una red de filamentos a partir de una imagen es uno de las formas que define la cantidad de informaci\'on disponible para llevar a cabo la individualizaci\'on de filamentos. La importancia de este procedimiento radica en que a partir de la imagen es posible obtener una cantidad de caracter\'isticas de distinta \'indole, lo que permite en etapas posteriores clasificar de diversas formas nodos, aristas, de forma aislada o en conjuntos, efectivamente disminuyendo el espacio de b\'usqueda. Con las herramientas actuales disponibles en la literatura, es posible realizar la extracci\'on de una red de filamentos con algún nivel de informaci\'on como en \cite{xu2015soax}. Sin embargo, las transformaci\'on de aquella red a un grafo, as\'i como la incorporaci\'on de las caracter\'isticas y/o propiedades hacia el grafo son un procedimiento no automatizado, por lo que el esfuerzo que el experto debe realizar es cercano a individualizar los filamentos de manera manual.

A partir de las investigaciones en la literatura, es posible agrupar los m\'etodos para extraer la informaci\'on que permite la construcci\'on de un grafo a partir de una imagen, como lo son los nodos y las aristas, en dos conjuntos: Los que se basan en esqueletonizaci\'on\cite{lavado2018comparacion} y los que no. 

\subsection{Extracci\'on de un Grafo mediante Esqueletonizaci\'on}
\label{subsec:infoLossSkel}

%Que es la skeletonizacion y como extrae el grafo. Uso de liberia sknw
Los m\'etodos basados en esqueletonizaci\'on consisten primariamente en la reducci\'on de los p\'ixeles pertenecientes al plano de inter\'es o {\it foreground} en una imagen binaria, hasta formar una representaci\'on del objeto en la imagen de 1 p\'ixel de ancho. El proceso debe mantener la conectividad del objeto adelgazado y a su vez, reducir la dimensi\'on del objeto en la imagen para facilitar su an\'alisis\cite{saha2017skeletonization}. Un an\'alisis de los vecindarios de los p\'ixeles del esqueleto construido es una de las formas m\'as sencillas en que se puede distinguir si un p\'ixel representa un nodo o si es parte de un arista. Una librer\'ia que realiza tal an\'alisis es {\it skan}\cite{nunez2018new}, entregando estad\'isticas del grafo extra\'ido como largo promedio de una rama del esqueleto (equivalente a una arista del grafo), tipo de rama, curvatura de una rama, entre otras mediciones. Sin embargo, el formato de salida del grafo para esta herramienta corresponde a {\it Compressed sparse row} o CSR, lo que causa que un an\'alisis de mayor profundidad o el paso del grafo a una herramienta de individualizaci\'on de filamentos necesite de una librer\'ia adicional. 


Otra herramienta que realiza un an\'alisis similar para obtener un grafo a partir de un esqueleto es {\it sknw}, parte del framework {\it ImagePy}\cite{wang2018imagepy}. La diferencia propuesta por {\it sknw} radica en que se integra con la librer\'ia {\it NetworkX}\cite{hagberg2008exploring}, utilizando la estructura de datos para grafos que esta \'ultima posee para elegir entre m\'ultiples formatos de salida. Aquello otorga flexibilidad en la integraci\'on de herramientas que utilizan como base el grafo para realizar an\'alisis posteriores, como es el caso de la individualizaci\'on de filamentos.

% se puede extraer el skeleton con librerias en varios lenguajes, como octave, matlab o python (usando scipy). La opci\'on se encuentra en la secci\'on de herramientas morfol\'ogicasd de cada uno. De ahi al grafo, se puede utilizar un procedimiento que haga an\'alisis de vecindarios de p\'ixeles como \cite{qiu2014quantitative}

%problema de skeleton
Independiente de la herramienta usada para obtener la informaci\'on topol\'ogica de la c\'elula observada, el procedimiento de esqueletonizaci\'on puede sufrir de p\'erdida de informaci\'on, dado que mediante el adelgazamiento utilizado se rompe la relaci\'on entre los p\'ixeles que conforman el elemento que se adelgaza y los p\'ixeles que constituyen el esqueleto obtenido. La informaci\'on que relaciona los p\'ixeles vecinos a los p\'ixeles del esqueleto es relevante ya que puede reflejar informaci\'on geom\'etrica como ancho o puede ser \'util al obtener informaci\'on derivada mediante m\'etodos como {\it image moments}\cite{flusser2009moments}\cite{chaumette2004image}. En base a lo anterior, se desarrolla una herramienta que captura esta informaci\'on a partir de la imagen usada en el proceso de esqueletonizaci\'on. A su vez, con esta herramienta tambi\'en es posible construir un grafo de la red de filamentos, sin embargo, el resultado no es de alta calidad. El procedimiento consta de los siguientes pasos:
% explicar que el hecho de G completo mediante lo q la arista es al problema de identificación de filamentos
%presento el extractor aproximado de grafos, la noción de puntos cluster/superPixels/blobs y el centro de masa como representante, dado que se puede obtener de forma simple mediante los "image moments". Además, distintos niveles de image moments permiten obtener información adicional útil en la descripción del cluster.

\begin{enumerate}
    \item Se generan clusters, tambi\'en llamados {\it super pixels} mediante una agrupaci\'on en base a un kernel de tama\~no 3x3, que busca separar de forma local los pixels que corresponden a {\it background} y no aportan informaci\'on, con respecto a los que son parte de la c\'elula observada ({\it foreground}), siendo estos \'ultimos los que concentran el inter\'es para el an\'alisis. La creaci\'on de clusters permite establecer la primera informaci\'on de vecindarios.
    \item Cada cluster es representado por un nodo, ubicado en el centro de masa del {\it super pixel}. En conjunto con el centro de masa es posible obtener informaci\'on geom\'etrica mediante los {\it raw image moments}\cite{chaumette2004image} del cluster. En este punto tambi\'en se procede a realizar fusiones de clusters en base a 2 criterios: Aquellos clusters con un n\'umero de p\'ixeles inferior a un umbral definido por el par\'ametro {\it Max\_Thickness} y los clusters que s\'olo tengan 2 vecinos y se encuentren bajo un umbral de cercan\'ia definido por el par\'ametro {\it Connectivity\_Threshold}. El par\'ametro {\it Max\_Thickness} hace referencia al ancho promedio de un filamento en la imagen y es definido por el usuario, mientras que {\it Connectivity\_Threshold} es el resultado del m\'ultiplo entre {\it Max\_Thickness} y un factor que depende de la c\'elula observada, variando entre 0.4 y 0.5. Una de las ventajas de fusionar clusters bajo los criterios mencionados radica en identificar y eliminar ciclos triangulares entre vecinos, mejorando la informaci\'on de vecindarios, sirviendo como una heurística para limitar el n\'umero de nodos.
    
    %\item A partir de la informaci\'on de vecindario de los nodos definitivos obtenidos en el paso anterior, se generan aristas entre nodos vecinos. Se obtiene el largo e  informaci\'on angular para cada arista creada. %Esta \'ultima es utilizada m\'as adelante para definir puntos de partida de las hormigas.
\end{enumerate}

Para asociar la informaci\'on de los vecindarios creados mediante los clusters con la informaci\'on extra\'ida mediante la esqueletonizaci\'on, se realiza un procedimiento similar al del paso 2, donde los nodos que representan clusters son fusionados con los nodo del esqueleto. 
Utilizando la posici\'on del nodo del esqueleto como centro de una matrix de tama\~no 3x3, se obtienen los clusters a los que pertenecen estos p\'ixeles. los cuales son absorbidos por el nodo del esqueleto respectivo, formando un nuevo cluster. Este nuevo cluster reemplaza a los clusters absobidos, heredando los vecinos que estos ten\'ian, pero manteniendo la posici\'on del nodo del esqueleto.

%Se define como generador {\it aproximado} de grafos debido a que puede sufrir de peque\~nas desviaciones en la ubicaci\'on de los nodos y las aristas con respecto a lo que otras herramientas de esqueletonizaci\'on e identificaci\'on de intersecciones en conjunto pueden hacer en la misma tarea. Uno de los objetivos en la creaci\'on del generador {\it aproximado} de grafos se debe a que facilita el uso de im\'agenes encontradas en el estado del arte.

En el caso que no sea posible obtener grafo mediante la esqueletonizaci\'on de la imagen, esta herramienta considera un paso adicional al procedimiento de 2 pasos presentado previamente. El tercer paso consiste en generar aristas entre los nodos vecinos, en base a la informaci\'on de vecindario, obteniendo el largo e informaci\'on angular para cada arista creada. El grafo generado se denomina como un grafo aproximado, ya que puede presentar deformaciones.


\subsection{Obtenci\'on de Informaci\'on Adicional}

Para dar uso a la informaci\'on recuperada de acuerdo a lo expresado en la secci\'on \ref{subsec:infoLossSkel}, se analizaron diversos filtros \'utiles para describir estructuras alargadas, como {\it Gabor}, {\it Anistropic Diffusion} y Frangi para {\it Veselness}. El filtro Frangi para {\it Veselness}\cite{frangi1998multiscale}\cite{fu2018frangi}, cuantifica cuan alargada es una estructura ({\it veselness value}), en base a los eigenvectores y eigenvalores de la matriz Hessiana (ecuaci\'on \eqref{eq:HessianMat}) posterior a la aplicaci\'on de uno o varios filtros Gaussianos para suavizar una imagen. Este filtro es utilizado en la detecci\'on de estructuras alargadas como arterias y venas, pudiendo replicarse parcialmente mediante el an\'alisis de p\'ixeles con {\it image moments}\cite{flusser2009moments}. La posibilidad de replicar el filtro de Frangi, sin necesidad de configurar par\'ametros, es lo que llev\'o a elegirlo por sobre las otras opciones.

\begin{equation}
    \label{eq:HessianMat}
    H = \begin{bmatrix}
        H_{xx} & H_{xy} \\
        H_{xy} & H_{yy} 
        \end{bmatrix}
\end{equation}

Una respuesta de {\it veselness value} que denota una estructura alargada se obtiene si los 2 eigenvalores, $\lambda_1$ y $\lambda_2$ ($|\lambda_2| \geq |\lambda_1|$) satisfacen $|\lambda_1| \approx 0 $ y $|\lambda_2| \gg |\lambda_1|$. Los eigenvalores se obtienen mediante la ecuaci\'on \ref{eq:lambdaFrangi}.

\begin{equation}
    \label{eq:lambdaFrangi}
    \lambda_{1,2} = \dfrac{(H_{xx} + H_{yy}) \pm \sqrt{(H_{xx} - H_{yy})^{2} + 4\cdot H_{xy}^{2}     } }{2}
\end{equation}

Otra forma de obtener los valores de lambda de la ecuaci\'on \ref{eq:lambdaFrangi} es utilizando los {\it central image moments} o momentos centrales, que derivan de los {\it raw image moments} obtenidos en el segundo paso la herramienta para recuperar informaci\'on presentada en la secci\'on \ref{subsec:infoLossSkel}. Se define un {\it raw image moment} de orden $p+q$ para una imagen en la ecuaci\'on \eqref{eq:rawImageMoment}, donde $f(x,y)$ corresponde a la intensidad de la imagen en un punto (x,y). El {\it raw moment} $M_{00}$ refleja la "masa" de la imagen, correspondiendo al \'area o volumen si se trata de una imagen binaria. 

Para el c\'alculo de los momentos centrales se agregan los componentes del centroide, $\overline{x}$ e $\overline{y}$, basados en los {\it raw moments}, como indican las ecuaciones \eqref{eq:avgFromRawMomts} y \eqref{eq:centralImageMoment}.

\begin{subequations}
\begin{equation}
    \label{eq:rawImageMoment}
    M_{pq} = \sum\limits_{x} \sum\limits_{y} x^p \cdot y^q \cdot f(x,y)
\end{equation}
\begin{equation}
    \label{eq:avgFromRawMomts}
    \overline{x} = \frac{M_{10}}{M_{00}}, \quad
    \overline{y} = \frac{M_{01}}{M_{00}}
\end{equation}
\begin{equation}
    \label{eq:centralImageMoment}
    \mu_{pq} = \sum\limits_{x} \sum\limits_{y} (x - \overline{x})^{p} \cdot (y - \overline{y})^{q} \cdot f(x,y)
\end{equation}
\end{subequations}

As\'i, es posible construir una matriz de covarianza, equivalente a la matriz hessiana en la ecuaci\'on \eqref{eq:HessianMat}, utilizando los momentos centrales de segundo orden, $\mu_{20}$, $\mu_{02}$ y $\mu_{11}$ divididos por el momento central de orden cero $\mu_{00}$ (ecuaciones \eqref{eq:mu20}, \eqref{eq:mu02} y \eqref{eq:mu11}), obteniendo los eigenvalores mediante la ecuaci\'on \eqref{eq:lambdaMoments}.

\begin{subequations}
\begin{align}
    \mu_{20}^{\prime} &= \frac{\mu_{20}}{\mu_{00}} = \frac{M_{20}}{M_{00}} - \overline{x}^{2} \label{eq:mu20} \\
    \mu_{02}^{\prime} &= \frac{\mu_{02}}{\mu_{00}} = \frac{M_{02}}{M_{00}} - \overline{y}^{2} \label{eq:mu02} \\
    \mu_{11}^{\prime} &= \frac{\mu_{11}}{\mu_{00}} = \frac{M_{11}}{M_{00}} - \overline{x}\cdot\overline{y} \label{eq:mu11}
\end{align}

\begin{equation}
    \label{eq:covMatLambda}
    cov[f(x,y)] = \begin{bmatrix}
        \mu_{20}^{\prime} & \mu_{11}^{\prime} \\
        \mu_{11}^{\prime} & \mu_{02}^{\prime} 
        \end{bmatrix}
\end{equation}

\begin{equation}
    \label{eq:lambdaMoments}
    \lambda_{1,2} = \dfrac{(\mu_{20}^{\prime} + \mu_{02}^{\prime}) \pm \sqrt{(\mu_{20}^{\prime} - \mu_{02}^{\prime})^{2} + 4\cdot \mu\prime_{11}^{2} }}{2}
\end{equation}
\end{subequations}

Con los valores de $\lambda$, es posible calcular caracter\'isticas de una estructura alargada como su excentricidad o su eje principal de inercia. Estas medidas pueden ayudar a mejorar la clasificaci\'on de segmentos del grafo durante la identificaci\'on de filamentos.


% informacion geometrica mediante calculo de angulos entre aristas
Un manera adicional de generar informaci\'on que facilite la discriminaci\'on de secciones del grafo es a trav\'es del c\'alculo de los \'angulos entre las aristas del grafo. Esto se relaciona a criterio de rectitud que tienen los filamentos, que var\'ia dependiendo de la c\'elula a la que pertenezca. Este comportamiento de los filamentos permite delimitar el \'angulo m\'aximo que 2 aristas contiguas pueden tener para ser considerados parte del mismo filamento, denomin\'andose este umbral como $Max\_Angle$. Cualquier valor por sobre $Max\_Angle$ permite descartar de forma absoluta esa combinanci\'on de aristas para un mismo filamento. 


A su vez, este criterio posee un segundo umbral, definido como $\theta$  que define el \'angulo m\'aximo bajo el que se considera que 2 aristas contiguas respetan con certeza la rectitud necesaria para formar parte del mismo filamento. Es decir, si 2 aristas contiguas forman un \'angulo en el rango $[0, \theta]$, deben ser parte del mismo filamento. El rango entre ambos umbrales, $]\theta, Max\_Angle]$ delimita los pares de aristas que a priori no representan combinaciones que respetan el criterio de rectitud, pero cuya explicaci\'on puede encontrarse en variaciones inducidas durante la extracci\'on del grafo desde la imagen, por lo que es necesario incorporar la exploraci\'on de estos pares de aristas.


Finalmente, para el caso de los nodos, el an\'alisis del grado de cada uno permite identificar la existencia de ciclos\cite{wilson1979introduction} en un filamento. La propiedad de un filamento de poder o no tener un ciclo es informaci\'on disponible priori que depende del tipo de c\'elula observada, permitiendo limitar posibles asociaciones entre nodos. En el caso particular de no permitir ciclos, un filamento no podr\'ia pasar m\'as de una vez por cada nodo que lo conforma. 

%se destaca dentro de los criterios: busca evitar perder información de la imagen/ampliar la informacion así como tener un costo computacional bajo, en conjunto con disminuir la interacción del usuario. 


% ambas opciones generan degeneraciones/deformaciones q afectan
\section{Exploraci\'on del Espacio de Soluciones}

La b\'usqueda de conjuntos de nodos o aristas adyacentes (denominados caminos) en un grafo, para individualizar uno o m\'as filamentos, constituye un espacio de soluciones que no es posible de recorrer en tiempo polinomial, dado que sin restricciones las combinaciones crecen exponencialmente\cite{buchin2007number}\cite{biswas2012hamiltonian}. Un planteamiento similar a lo anterior es el {\it Path Cover Problem} o PCP, en el que se descompone un grafo dirigido en caminos con el objetivo de obtener un conjunto de caminos. Cada nodo o arista debe pertenecer exactamente a un camino y los caminos pueden comenzar o terminar en cualquier parte del grafo.

En el caso de la individualizaci\'on de filamentos, es necesario que la definici\'on del problema considere como v\'alidos caminos que representen los casos de filamentos con o sin ciclos, as\'i como superposici\'on y/o cruce. Lo anterior impide forzar la pertenencia de un nodo o arista a un s\'olo camino. 

% explicar define: como lo hace define? y como se observa la potencial perdida de soluciones factibles al usar un solo criterio
La investigaci\'on de \cite{breuer2015define}, denominada {\tt DeFiNe}, descrita brevemente en el cap\'itulo \ref{chap:stateoftheart} presenta el {\it Filament Cover Problem} o FCP como una extensi\'on del PCP, flexibilizando la pertenencia de cada arista a al menos un camino. Adem\'as plantean como funci\'on objetivo la minimizaci\'on de la diferencia de la homogeneidad (aspereza) entre las aristas que componen un camino. Para acotar el espacio de soluciones, los autores de DeFiNe proponen 2 heur\'isticas fundamentando que el FCP en \'arboles en vez de grafos es soluble en tiempo polinomial. Aquello se basa en lo definido por \cite{lin2006vertex} que indica que para un problema de {\it covering}, existe un {\it Set System} $(S,C)$, donde S es el conjunto total y finito de sets, y C es un conjunto de subsets pertenecientes a S. En el caso espec\'ifico del {\it Minimum Set Cover} (MSC), el objetivo es encontrar un subconjunto $C'$ de $C$ tal que cada elemento de $S$ pertenezca al menos 1 vez a uno de los miembros de $C'$.

%Un grafo completamente conectado puede tener n(n-1)/2 aristas, lo que para un n muy grande puede implicar un costo computacional alto
%A su vez, otro motivo para evitar que $G$ sea un grafo completo radica en que para los filamentos observados en la naturaleza no es una condici\'on comun... no encuentro la fuente de esto

%Denominamos todas estas opciones de caminos como el conjunto $P$, del cual debemos extraer un subconjunto $P'$ mediante una estrategia que permita realizar esto en tiempo polinomial independientemente de la cantidad de aristas del grafo.

Para un {\it set system} $(S,C)$ que pueda ser representando por un \'arbol $T$, es posible mutar la definici\'on de $S$ al conjunto de nodos que componen un grafo $G$, y a su vez, hacer que cada subset $c \in C$ represente un camino simple en $G$. Un camino simple es equivalente a un \'arbol simple (2 nodos son unidos por a lo m\'as 1 arista) y ac\'iclico.


Se destaca en \cite{lin2006vertex} que no todos los caminos simples de $G$ est\'an representados en $C$. Esta representaci\'on de {\it covering} de caminos, o {\it Path Cover}, es denominada {\it Vertex Covering by Paths on Graphs} (VcpG) y difiere de un {\it Path Cover} tradicional al permitir caminos que compartan nodos. Luego, para el caso de \'arboles, VcpG se renombra a VcpT ({\it Vertex Covering by Paths on Trees}), permitiendo el reemplazo de nodos por aristas sin generar cambios significativos en el planteamiento del problema. Esta modificaci\'on de nodos a aristas se denomina EcpT ({\it Edge Covering by Paths on Trees}). %recordar mas adelante como posible perdida de soluciones factibles


Lo anterior establece el fundamento para que los autores de DeFiNe\cite{breuer2015define} utilicen EcpT como base, teniendo un m\'aximo de caminos $n(n)-1/2 = \mathcal{O}(n^{2})$, con una complejidad $\mathcal{O}(n^{4})$ para obtener esos caminos. La obtenci\'on de caminos a partir de un \'arbol $T$ que contiene los nodos del grafo $G$ se realiza mediante la divisi\'on continua del \'arbol en m\'ultiples bosques, hasta que los bosques resultantes sean s\'olo caminos simples. Sin embargo, los caminos resultantes no comparten nodos o aristas, es decir, no se superponen. Para solucionar aquello manteniendo la resoluci\'on del FCP en tiempo polinomial, se agrega en DeFiNe el par\'ametro $k$, que define el n\'umero m\'aximo de superposiciones de caminos en una arista. La complejidad con el nuevo par\'ametro queda como $\mathcal{O}(n^{2k+2})$.


%aca entran las formas de obtener esos arboles simples y bosques, con las heuristicas de define
Dado que el conjunto total de caminos en un grafo, definido como $P$, no es calculables en tiempo polinomial, DeFine propone 2 heur\'isticas para construir \'arboles de los cuales se puedan extraer un conjunto representativo de caminos simples, definidos como $P'$. Cada una de las heur\'isticas, {\it BFS} y {\it RMST}, explicadas en el cap\'itulo \ref{chap:stateoftheart}, proveen un conjunto $P'$, al que se le aplica la funci\'on objetivo, para encontrar los miembros de $p \in P'$ que mejor minimicen la diferencia de homogeneidad en sus caminos. La restricci\'on de lo anterior es que cada arista del grafo pertenezca a lo menos a un camino. 

%\begin{equation}
%p = (e_1, e_2,..., e_n)\\
%p = ((v_1,v_2), (v_2,v_4),..., (v_n-1,v_n))
%\label{eq:path}
%\end{equation}

% Comparándose con define, Problema 1 caminos validos no llegan a P'

La generaci\'on del conjunto $P'$ planteado en DeFiNe puede llevar a excluir caminos v\'alidos al realizar la representaci\'on de un {\it set system} mediante un \'arbol, o al utilizar una sola propiedad asociada a un filamento en una de sus heur\'isticas. 


El presente trabajo plantea en el cap\'itulo \ref{sec:modeloOpti} un modelo de optimizaci\'on que permite generar caminos utilizando m\'as de una propiedad asociada a un filamento o al grafo que representa la red de filamentos. Esto permite individualizar filamentos en casos de superposici\'on, cruce o discriminando si el filamento puede tener o no ciclos. Adem\'as se presentan diversas heur\'isticas para reducir el tama\~no del espacio de soluciones.

%Ejemplo camino verde en Spinning Marchantia (imagenes)


